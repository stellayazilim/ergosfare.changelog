import { SparkleIcon } from '@/components/SparkleIcon'

export { Layout as default } from '@/components/Layout'

---

## v0.1.0e â€“ First minor release - {{ date: '2025-09-18' }}

### <SparkleIcon /> Final Interceptors

* âš¡ Introduced new interfaces:

  * âš¡ `IFinalInterceptor`, `IAsyncFinalInterceptor<TMessage, TResult>` for generic/non-generic messages.
  * âš¡ `ICommandFinalInterceptor`, `IQueryFinalInterceptor`, `IEventFinalInterceptor` for higher-level modules.
* âš¡ Final interceptors now run at the end of the pipeline (in `finally`), enabling cleanup and logging scenarios.
* âš¡ Support for nullable message results and exceptions passed into final interceptors.

### <SparkleIcon /> Pre- & Post-Interceptors

* **Pre-Interceptors**:

  * âš¡ Added support for both direct and indirect pre-interceptors.
  * âš¡ Can mutate messages and return a new one.
  * âš¡ Emit detailed events (`BeginPreIntercepting`, `FinishPreInterceptorInvocation`, etc.).

* âš¡ **Post-Interceptors**:

  * âš¡ Added support for both direct and indirect post-interceptors.
  * âš¡ Can mutate results before returning to the caller.
  * âš¡ Integrated `IResultAdapterService` to detect embedded exceptions in results.
  * âš¡ Emit events for normal execution and exception-like results (`FinishPostInterceptingWithException`).

### <SparkleIcon /> Exception Interceptors

* âš¡ Support for direct and indirect exception interceptors.
* âš¡ Emit begin/finish events for each interceptor.
* âš¡ Full support for nullable `messageResult`.
* âš¡ Rethrows exceptions if no interceptors are registered.

### <SparkleIcon /> Unified Pipeline Events

* âš¡ Refactored **EventHub â†’ SignalHub**, and renamed `HubEvent â†’ Signal` for clarity.
* âš¡ Introduced `PipelineEvent` base class (with `Message` and nullable `Result`).
* âš¡ Standardized event naming:

  * âš¡ Pre: `BeginPreInterceptingEvent`, `FinishPreInterceptorInvocationEvent`, â€¦
  * âš¡ Post: `BeginPostInterceptingEvent`, `FinishPostInterceptorInvocationEvent`, â€¦
  * âš¡ Exception: `BeginExceptionInterceptingEvent`, `FinishExceptionInterceptorInvocationEvent`
  * âš¡ Final: `BeginFinalInterceptingEvent`, `FinishFinalInterceptorInvocationEvent`
* âš¡ Events carry metadata (interceptor type, exception, total count).
* âš¡ Unified equality comparison for better test coverage.

### <SparkleIcon /> Result Adapter

* âš¡ Added `IResultAdapter` and `IResultAdapterService`:

  * âš¡ Detect exceptions inside result objects (e.g., `ErrorOr`).
  * âš¡ Allow exception interceptors to run without throwing original result types.
* âš¡ Integrated with post-interceptors and mediators for consistent handling.

### <SparkleIcon /> Mediators

* âš¡ `QueryMediator` and `EventMediator` updated to raise pipeline events.
* âš¡ Integrated `IResultAdapterService` into mediation strategies (`SingleAsyncHandlerMediationStrategy`, `AsyncBroadcastMediationStrategy`).
* âš¡ Improved async flow and nullability handling.

### <SparkleIcon /> Execution Strategies & Handler Invokers

* âš¡ Refactored pipeline execution strategies with final interceptor support.
* âš¡ Introduced **Handler Invokers**:

  * âš¡ Type-safe replacement for `MessageDependencyExtensions`.
  * âš¡ Unified mechanism for invoking handlers and interceptors.
  * âš¡ Integrated seamlessly with signals.

### <SparkleIcon /> Centralized Test Fixtures

* âš¡ Added new `Ergosfare.Test.Fixtures` assembly.
* âš¡ Common fixtures consolidated for reuse across test classes.
* âš¡ Introduced categorized stubs and stub factories to reduce inline stubs.
* âš¡ Improved maintainability, readability, and pluggability of test suite.
* âš¡ Achieved **95%+ coverage** with fixture-based test design.


### <SparkleIcon /> Fixes & Refactors

* âš¡ Cleaned up pipeline flow with consistent async/await handling.
* âš¡ Removed `MessageDependencyExtensions` in favor of handler invokers.
* âš¡ Unified naming across signals and interceptors.
* âš¡ Simplified exception interception without reflection/dynamic.


### <SparkleIcon /> Benefits

* âš¡ Final interceptors enable safe cleanup and logging.
* âš¡ Pre- and post-interceptors can mutate messages and results consistently.
* âš¡ Exception handling is safer, with result-based error detection via adapters.
* âš¡ Unified event/signal system improves observability and debugging.
* âš¡ Stronger modularity for command, query, and event pipelines.
* âš¡ Centralized, reusable test infrastructure.
* âš¡ Easier to maintain, extend, and test pipelines.

### <SparkleIcon /> Tests

* âš¡ Fixture-based tests for:

  * âš¡ `ErrorOr` adapter support.
  * âš¡ Exception interception (direct/indirect).
  * âš¡ Post-interceptor result exceptions.
* âš¡ Updated tests for signal structure, handler invokers, and fixtures.
* âš¡ Achieved consistent **95%+ coverage**.

---

## v0.0.16e â€“ IHasProxyEvents - {{ date: '2025-09-11' }} 
### <SparkleIcon /> **Added**
- âš¡ IHasProxyEvents interface, contains all known proxy events
- âš¡ EventHub now implements IHasProxyEvents
- âš¡ Now known pipeline events subscrible with += and unsubscrible with -= syntax from EventHub

---

## v0.0.15e â€“ Pipeline Event System Refactor & Coverage - {{ date: '2025-09-03' }}

### <SparkleIcon /> **Added**

* `PipelineEvent` abstract base class (formerly `PipelineEventBase`) with:
  * `Timestamp` auto-initialization
  * `RelatedEvents` support (`Add`, `AddRange`)
  * `GetEqualityComponents()` for value-based equality
* 20+ concrete pipeline events:
  * `BeginExceptionInterceptingEvent`, `BeginExceptionInterceptorInvocationEvent`, `BeginHandlerInvocationEvent`, `BeginHandlingEvent`, `BeginPipelineEvent`
  * `BeginPostInterceptingEvent`, `BeginPreInterceptorInvocationEvent`, `FinishExceptionInterceptingEvent`, `FinishExceptionInterceptorInvocationEvent`
  * `FinishHandlerInvocationEvent`, `FinishHandlingEvent`, `FinishHandlingWithExceptionEvent`, `FinishPipelineEvent`
  * `FinishPostInterceptingEvent`, `FinishPostInterceptingWithException`, `FinishPostInterceptorInvocationEvent`
  * `FinishPreInterceptingEvent`, `FinishPreInterceptingWithException`, `FinishPreInterceptorInvocationEvent`
* Factory methods (`Create`) for all pipeline events with null checks and default handling (`ResultType ?? typeof(void)`)
* Static subscription & publish support via `PipelineEvent.Subscribe<TEvent>`
* In-place instance invocation via `Invoke()` extension method

### <SparkleIcon /> **Changed**

* Renamed `PipelineEventBase` â†’ `PipelineEvent`
* `HubEvent` updated:

  * `Timestamp` is instance-based, not static
  * `GetHashCode` and `Equals` use `GetEqualityComponents()`
  * `RelatedEvents` added to allow event chaining

### <SparkleIcon /> **Fixed / Improved**

* Full unit test coverage for:

  * All pipeline events (`Create`, `GetEqualityComponents`, equality, timestamp)
  * `RelatedEvents` behavior (add, add range, read-only enforcement)
  * Static subscription / publish mechanics
  * In-place `Invoke()` calls

### <SparkleIcon /> **Impact**

* Event pipeline fully type-safe and decoupled
* Subscribers can register without creating instances
* Improved consistency and maintainability of pipeline events

### <SparkleIcon /> **Testing**
- Unit tests updated to account for recent changes in HubEvent and PipelineEvent

- New unit tests added for all new pipeline events and related components

- RelatedEvents functionality fully tested (add, add range, read-only enforcement)

- Static subscription and in-place Invoke() methods tested for all pipeline events

- Value-based equality (GetEqualityComponents, Equals, GetHashCode) fully covered

- Maintained 100% test coverage for all event classes and base logic

---

## v0.0.14e â€“ Event Hub Refines & Proxy Event System - {{ date: '2025-09-03' }}
### <SparkleIcon /> New Features
* Generic Event Hub (EventHub): Supports strongly-typed events using `HubEvent` base class, with strong and weak subscriptions.
* Proxy Events (`ProxyEvent<T>`)  
Subscribe to predefined events using += and unsubscribe using -= syntax for cleaner code.
* Predefined Event: `PreInterceptorBeingInvokeEvent` added as a foundational example for interceptors and handlers.
* Custom Events: Subscribe, publish, and unsubscribe custom HubEvent types independently of predefined proxies.
* Value Object Base for Events:
HubEvent includes equality operators (`==`, `!=`) and value-based `Equals` / `GetHashCode` for future-proof event comparisons.

### <SparkleIcon /> Improvements
* Thread-safe subscriptions using ConcurrentDictionary and locking.
* Automatic cleanup of dead weak subscriptions during event publishing.

### <SparkleIcon /> Removals
* `ISubscription` and `IHubEvent` interfaces have been removed.
* Replace `ISubscription` with `ISubscription<TEvent>`
* Replace `IHubEvent` with the abstract `HubEvent` class

### <SparkleIcon /> Testing - Unit tests enhanced to cover:
* Strong/weak subscription invoke behavior
* Proxy `+=` / `-=` operators
* Subscription matching and unsubscription
* Base HubEvent equality and hash code computation

### <SparkleIcon /> Keynotes
* This release lays the foundation for next-generation plug-ins and modules, allowing n-party decoupled event-driven integrations.

* Users can create their own events implementing HubEvent for custom plugin scenarios.

---

## v0.0.13e - Republish of v0.0.12e - {{ date: '2025-09-03' }}
- no changes

---

## v0.0.12e - EventHub - {{ date: '2025-09-03' }}

### <SparkleIcon /> **New Features**

* **Centralized EventHub**: A thread-safe, global hub for Pre, Post, Handler, and Exception stage events.
* **Weak and Strong Subscriptions**: Subscribers can be registered as strong or weak references.

  * `IsAlive` property allows automatic cleanup of dead weak references.
  * Subscriptions implement `IDisposable`.
* **DI Integration**: EventHub now resolves via DI as a singleton using `EventHubAccessor`.
* **Thread-safe Publishing**: Publishing events is safe across multiple threads, with automatic cleanup of dead weak subscriptions.
* **Extensible Plugin Support**: Modules can subscribe to events without modifying core components.

####  **Keynote**

- This EventHub forms the foundation for future plugins and modules that do not need to be directly coupled with main modules.

- It enables developers to write their own n-party plugins, extending the system safely and independently.

#### **Side Note:**

* This EventHub system is **separate from the message mediation events** (pre/post/interceptor) used in command, query, and event pipelines.
* It provides a **general-purpose, centralized event mechanism** for modules and plugins to subscribe to runtime events without coupling to the core pipeline.


---

## v0.0.11e - Refactor {{ date: '2025-09-01' }}

### <SparkleIcon /> Changed

* `ActualTypeOrFirstAssignableTypeMessageResolveStrategy`

  * Now constructor-injected with `IMessageRegistry`.
  * Simplified `Find` method signature (`Find(Type)` instead of `Find(Type, IMessageRegistry)`).
* `MessageMediator` updated to use the simplified strategy method.
* DI registration added for `ActualTypeOrFirstAssignableTypeMessageResolveStrategy`.
* Unit tests updated to reflect new DI-based message resolution.

---

## v0.0.10e {{ date: '2025-08-31T00:00Z' }}

### <SparkleIcon /> Changed
- **Handlers & Interceptors**: Removed `CancellationToken` parameters from all contracts.  
Execution contextâ€™s token is now used consistently instead.

### <SparkleIcon /> Breaking Changes
- Any custom handlers or interceptors that previously accepted a `CancellationToken`  
must be updated to rely on the execution context for cancellation.

### <SparkleIcon /> Internal
- Refactored interface definitions to eliminate redundant token passing.
- Updated unit tests to use context-based cancellation.
- Coverage badge regenerated to reflect new code changes.

---

## v0.0.9e Pipeline flow fixes {{ date: '2025-08-30T00:00Z' }}


### <SparkleIcon /> Changed
- **Handlers**: Updated handler order grouping logic.
- **Interceptors**: Refined interceptor chaining based on group attributes.

### <SparkleIcon /> Fixed
- Resolved issue with default group assignment for ungrouped handlers.

### <SparkleIcon /> Internal
- Refactored handler registration process to streamline group assignment.

### <SparkleIcon /> Files Changed
- `HandlerRegistry.cs`
- `InterceptorChain.cs`

### <SparkleIcon /> Code Coverage
- Added tests for newly implemented functionality.

---

## v0.0.8e Pipeline flow control {{ date: '2025-08-28T00:00Z' }}
### <SparkleIcon /> Introduced
- `public class GroupAttribute(params string[] groupNames)`
- `public class WeightAttribute(uint weight)`

### <SparkleIcon /> New Features:
- Handler Grouping with GroupAttribute
- Handler Ordering with WeightAttribute

### <SparkleIcon /> Changes:
- IHandlerDescriptor has new two property `Weight` and `Groups`
- All handler descriptor builders updated internally to support grouping and ordering
- All internal mediator definitions updated to use grouping and ordering
- MessageDependencies and MessageDependenciesFactory updated internally
- TypeExtensions has new metohods `GetWeightFromAttribute()`, `GetGroupsFromAttribute()`

---

## Ergosfare v0.0.6e {{ date: '2025-08-26T00:00Z' }}


### <SparkleIcon /> New Features: Event module
#### ðŸ”¹IEventExceptionInterceptor && IEventExceptionInterceptor\<TEvent\> interfaces added 
    Event module now supports generic & non generic ExceptionInterceptors.
#### ðŸ”¹IEventPreInterceptor && IEventPreInterceptor\<TEvent\>
    Event module now supports generic &non generic PreInterceptors.
#### ðŸ”¹IEventPostInterceptor && IEventPostInterceptor\<TEvent\>
    Event module now supports generic &non generic PreInterceptors.



---


## Ergosfare v0.0.5e {{ date: '2025-08-17T00:00Z' }}

### <SparkleIcon /> No breaking changes
* **ðŸ”¹Refactor:** `CommandModuleBuilder.Register<T>()` now internally calls `CommandModuleBuilder.Register(Type T)`.
* **ðŸ”¹Refactor:** `MessageModule` renamed to `CoreModule`.
* **ðŸ”¹Refactor:**`CoreModule`.Build(...) implemented.
* **ðŸ”¹Chore:** Command module related tests and code coverage.

#### âœ… Test Coverage Milestone

* **ðŸ’¯ 100% test coverage** for `Ergosfare.Command`, `Ergosfare.Command.Abstractions`, `Ergosfare.Command.Extensions.MicrosfotDependencyInjection`.
* **ðŸ“Š Total project coverage:** 85%.

---


## Ergosfare v0.0.4e {{  date: '2025-08-16T00:00Z' }}

Core contracts moved to Core.Abstraction package for sake of dedicated contracts, Stream handling strategy updated
### <SparkleIcon /> Core Enhancements

* **ðŸ”¹ Refactor:** Base contracts moved from `Contracts` package into their dedicated project **Abstractions**.
* **ðŸ”¹ Refactor:** Streamlined `StreamAsyncMediationStrategy` for improved maintainability and clarity.
* **âœ¨ Feature:** Introduced **`IExceptionInterceptor`** handler, descriptor, and variants â€” all pipeline types now support exception interceptors.

### <SparkleIcon />  âœ… Test Coverage Milestone

* **ðŸ’¯ 100% test coverage** for `Ergosfare.Core.Abstractions`.
* **ðŸ“Š Total project coverage:** 67%.

---

```cs
public interface IAsyncPreInterceptor;
```
```cs
public interface IAsyncPreInterceptor<TMessage>;
```
```cs
public interface IAsyncPostInterceptor<TMessage>;
```
```cs
public interface IAsyncPostInterceptor<TMessage,TResult>;
```

## Ergosfare v0.0.3e {{  date: '2025-08-12T00:00Z' }}
### <SparkleIcon /> New features
* feat: pre/post Interceptor descriptor definitions
* feat: MessageDescriptorBuilderFactory supports building new interceptor descriptors
* feat: Message handlers now support pre/post interceptors
* feat: Mediation strategies updated to support IExecutionContext

### <SparkleIcon /> Bug Fix
* fix: correct PreInterceptorDescriptorBuilder filtering

### <SparkleIcon /> Other
* chore: Ergosfare.Core 100% covered with unit tests

